<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800">
  <!-- Styles -->
  <defs>
    <linearGradient id="nacosGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#d8f0ff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#a8d5f9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="istioGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e6f5e6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c2e0c2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="moduleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fff7dd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffe999;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="serverGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffefee;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffd6d4;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="eventGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f0e8f5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e1d0ed;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666666"/>
    </marker>
  </defs>

  <!-- Nacos Server Container -->
  <rect x="50" y="30" width="700" height="470" rx="10" ry="10" fill="url(#nacosGradient)" stroke="#3c78b5" stroke-width="2"/>
  <text x="400" y="60" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Nacos 服务端</text>
  <text x="400" y="85" font-family="Arial" font-size="14" text-anchor="middle">(端口: 18848)</text>

  <!-- Core Modules -->
  <rect x="80" y="100" width="160" height="70" rx="5" ry="5" fill="url(#moduleGradient)" stroke="#d6b656" stroke-width="1.5"/>
  <text x="160" y="130" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">注册中心核心</text>
  <text x="160" y="150" font-family="Arial" font-size="14" text-anchor="middle">(naming模块)</text>

  <rect x="550" y="100" width="160" height="70" rx="5" ry="5" fill="url(#moduleGradient)" stroke="#d6b656" stroke-width="1.5"/>
  <text x="630" y="130" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">配置中心核心</text>
  <text x="630" y="150" font-family="Arial" font-size="14" text-anchor="middle">(config模块)</text>

  <!-- Resource Manager -->
  <rect x="180" y="200" width="400" height="60" rx="5" ry="5" fill="url(#moduleGradient)" stroke="#d6b656" stroke-width="1.5"/>
  <text x="380" y="228" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">服务资源管理器 (ResourceManager)</text>
  <text x="380" y="248" font-family="Arial" font-size="12" text-anchor="middle">管理ResourceSnapshot</text>

  <!-- Event System -->
  <rect x="310" y="290" width="140" height="40" rx="5" ry="5" fill="url(#eventGradient)" stroke="#9673a6" stroke-width="1.5"/>
  <text x="380" y="315" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">事件处理系统</text>

  <!-- Protocol Support Modules -->
  <rect x="80" y="350" width="280" height="70" rx="5" ry="5" fill="url(#moduleGradient)" stroke="#d6b656" stroke-width="1.5"/>
  <text x="220" y="375" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">xDS 协议支持模块</text>
  <text x="220" y="395" font-family="Arial" font-size="14" text-anchor="middle">NacosXdsService</text>
  <text x="220" y="415" font-family="Arial" font-size="11" text-anchor="middle">(CDS/EDS服务)</text>

  <rect x="430" y="350" width="280" height="70" rx="5" ry="5" fill="url(#moduleGradient)" stroke="#d6b656" stroke-width="1.5"/>
  <text x="570" y="375" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">MCP 协议支持模块</text>
  <text x="570" y="395" font-family="Arial" font-size="14" text-anchor="middle">NacosMcpService</text>
  <text x="570" y="415" font-family="Arial" font-size="11" text-anchor="middle">(ServiceEntry资源配置)</text>

  <!-- Istio Server -->
  <rect x="130" y="440" width="540" height="110" rx="5" ry="5" fill="url(#serverGradient)" stroke="#b85450" stroke-width="1.5"/>
  <text x="400" y="460" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Istio服务器 (IstioServer)</text>
  <text x="400" y="480" font-family="Arial" font-size="12" text-anchor="middle">配置项: nacos.istio.mcp.server.enabled, nacos.istio.server.full</text>

  <!-- Server Components -->
  <rect x="170" y="490" width="130" height="40" rx="5" ry="5" fill="white" stroke="#666666" stroke-width="1"/>
  <text x="235" y="515" font-family="Arial" font-size="14" text-anchor="middle">CDS/EDS服务</text>

  <rect x="320" y="490" width="140" height="40" rx="5" ry="5" fill="white" stroke="#666666" stroke-width="1"/>
  <text x="390" y="515" font-family="Arial" font-size="14" text-anchor="middle">服务推送管理</text>

  <rect x="480" y="490" width="130" height="40" rx="5" ry="5" fill="white" stroke="#666666" stroke-width="1"/>
  <text x="545" y="515" font-family="Arial" font-size="14" text-anchor="middle">ServiceEntry</text>
  
  <!-- Istio/Envoy Container -->
  <rect x="180" y="580" width="400" height="140" rx="10" ry="10" fill="url(#istioGradient)" stroke="#82b366" stroke-width="2"/>
  <text x="380" y="605" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">Istio/Envoy</text>

  <!-- Envoy Proxy and Istio Control Plane -->
  <rect x="200" y="625" width="170" height="80" rx="5" ry="5" fill="white" stroke="#666666" stroke-width="1"/>
  <text x="285" y="645" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Envoy代理</text>
  <text x="285" y="665" font-family="Arial" font-size="12" text-anchor="middle">xDS客户端</text>
  <text x="285" y="685" font-family="Arial" font-size="11" text-anchor="middle">发送DiscoveryRequest请求</text>

  <rect x="390" y="625" width="170" height="80" rx="5" ry="5" fill="white" stroke="#666666" stroke-width="1"/>
  <text x="475" y="645" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Istio控制平面</text>
  <text x="475" y="665" font-family="Arial" font-size="12" text-anchor="middle">MCP客户端</text>
  <text x="475" y="685" font-family="Arial" font-size="11" text-anchor="middle">获取ServiceEntry等配置</text>

  <!-- Simple Connection Lines -->
  <!-- Vertical connections -->
  <line x1="160" y1="170" x2="200" y2="200" stroke="#666666" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="630" y1="170" x2="550" y2="200" stroke="#666666" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="380" y1="260" x2="380" y2="290" stroke="#666666" stroke-width="1.5"/>
  <line x1="340" y1="330" x2="220" y2="350" stroke="#666666" stroke-width="1.5"/>
  <line x1="420" y1="330" x2="570" y2="350" stroke="#666666" stroke-width="1.5"/>
  <line x1="220" y1="420" x2="220" y2="440" stroke="#666666" stroke-width="1.5"/>
  <line x1="570" y1="420" x2="570" y2="440" stroke="#666666" stroke-width="1.5"/>

  <!-- Communication Lines -->
  <line x1="235" y1="550" x2="235" y2="580" stroke="#666666" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="235" y="570" font-family="Arial" font-size="11" text-anchor="middle">xDS</text>
  
  <line x1="545" y1="550" x2="545" y2="580" stroke="#666666" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="545" y="570" font-family="Arial" font-size="11" text-anchor="middle">MCP</text>

  <!-- Communication with clients -->
  <line x1="235" y1="580" x2="285" y2="625" stroke="#666666" stroke-width="1.5"/>
  <line x1="545" y1="580" x2="475" y2="625" stroke="#666666" stroke-width="1.5"/>

  <!-- Protocol Labels -->
  <rect x="130" y="550" width="210" height="20" rx="10" ry="10" fill="#e1d0ed" stroke="#9673a6" stroke-width="1"/>
  <text x="235" y="565" font-family="Arial" font-size="12" text-anchor="middle">gRPC (xDS协议) 双向通信</text>
  
  <rect x="430" y="550" width="230" height="20" rx="10" ry="10" fill="#e1d0ed" stroke="#9673a6" stroke-width="1"/>
  <text x="545" y="565" font-family="Arial" font-size="12" text-anchor="middle">gRPC (MCP协议) 双向通信</text>
</svg>
